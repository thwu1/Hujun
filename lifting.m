function [ u_out,v_out,p_out ] = lifting( u,v,p )
%
N = size(p,1);

p_out( 1:2:2*N,1:2:2*N ) = p;
p_out( 2:2:2*N,1:2:2*N ) = p;
p_out( 1:2:2*N,2:2:2*N ) = p;
p_out( 2:2:2*N,2:2:2*N ) = p;

v_out( 1:2:2*(N+1),1:2:2*N ) = v;
v_out( 1:2:2*(N+1),2:2:2*N ) = v;
v_out( 2:2:2*N,1:2:2*N ) = 0.5 * (v( 1:N,: ) + v( 2:N+1,: ));
v_out( 2:2:2*N,2:2:2*N ) = 0.5 * (v( 1:N,: ) + v( 2:N+1,: ));

u_out( 1:2:2*N,1:2:2*(N+1) ) = u;
u_out( 2:2:2*N,1:2:2*(N+1) ) = u;
u_out( 1:2:2*N,2:2:2*N ) = 0.5 * (u( :,1:N ) + u( :,2:N+1 ));
u_out( 2:2:2*N,2:2:2*N ) = 0.5 * (u( :,1:N ) + u( :,2:N+1 ));